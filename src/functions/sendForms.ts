import { getForms } from './getForms';
import { ACP_ONLY, DAICHI2_ACP_URL, DAICHI2_HOME_URL } from 'constants';
import { sendDataToReceiver } from './sendDataToReceiver';
import { unique } from 'utils';

export const sendForms = () =>
	getForms(ACP_ONLY ? DAICHI2_ACP_URL : DAICHI2_HOME_URL).then((sources) => {
		sendDataToReceiver({
			context: 'forms',
			message:
				'\n-- **Forms** --\n\n' +
				unique(
					Object.values(sources)
						.map((forms) => forms.map((form) => `- \`${form.action}\` (${form.method})`))
						.flat()
				).join('\n'),
			json: JSON.stringify(sources),
		});
	});
