<?php

$request = isset($_GET['request']) ? $_GET['request'] : '';
$requested_file = basename($request);

/**
 * @param string $str1
 * @param string $str2
 * @return bool
 */
function str_ignore_case_compare(string $str1, string $str2): bool
{
	$str1 = mb_strtolower($str1);
	$str2 = mb_strtolower($str2);

	return $str1 === $str2;
}

if (str_ignore_case_compare($requested_file, 'server_info.json')) {
	$server_info = json_decode(file_get_contents('https://patch.daichi2.com/server_info.json'));

	$server_info->RemoteUpdaterURL = 'http://patch.daichi2.co/GameUpdater.exe';
	$server_info->MirrorList = ['http://patch.daichi2.co/Client/'];

	echo json_encode($server_info);

	exit();
}

header("Location: https://patch.daichi2.com/$request");
exit();
